#!/bin/bash

clone () {
    echo "cloning $1"

    case $1 in
        console )  [[ -d console ]] || git clone https://github.com/hoobs-org/helm.git
                   [[ -d console ]] || mv helm console
                   (cd console && git checkout blackwing)
                   ;;

        repo )      [[ -d repo ]] || git clone https://github.com/hoobs-org/repo.git
                    ;;

        security )  [[ -d security ]] || git clone https://github.com/hoobs-org/security.git
                    ;;

        * )         [[ -d $1 ]] || git clone https://github.com/hoobs-org/$1.git
                    (cd $1 && git checkout blackwing)
                    ;;
    esac
}

install () {
    echo "installing $1"

    (cd $1 && npm install)
}

push () {
    echo "pushing $1"

    (cd $1 && git push)
}

pull () {
    echo "pulling $1"

    (cd $1 && git pull && git checkout blackwing)
}

build () {
    case $1 in
        console )  (cd console && project build)
                   ;;

        image )    (cd image && project build $2)
                   ;;

        lang )     ;;

        network )  (cd network && project build)
                   ;;

        pam )      (cd pam && project build)
                   ;;

        portal )   (cd portal && project build)
                   ;;

        * )        ;;
    esac
}

edit () {
    case $1 in
        scripts )  nano project
                   ;;

        * )        nano HOOBS.code-workspace
                   ;;
    esac
}

case $1 in
    setup )  clone console
             clone image
             clone network
             clone pam
             clone portal
             clone repo
             clone sdk
             clone security

             install console
             install network
             install pam
             install portal
             install sdk
             ;;

    push )   push console
             push image
             push network
             push pam
             push portal
             push repo
             push sdk
             push security
             ;;

    pull )   pull console
             pull image
             pull network
             pull pam
             pull portal
             pull repo
             pull sdk
             pull security

             install console
             install network
             install pam
             install portal
             install sdk
             ;;

    build )  build $2 $3
             ;;

    edit )   edit $2
             ;;

    * )      ;;
esac
